# item12. toString을 항상 재정의하라

## toString 메서드는 필요에 맞게 재정의해야 한다.&#x20;

Object의 Default toString 메서드는 작성한 클래스의 적합한 문자열을 반환하는 경우는 없다.&#x20;

Object의 기본 toString 메서드의 기본 반환 값은 <mark style="color:orange;">**클래스\_이름\_@16진수로\_표현한\_해시코드**</mark>_이다._ 이는 '간결하면서 사람이 읽기 쉬운 형태의 유익한 정보를'를 반환해야 한다는 toString의 일반 규약에 어긋난다.&#x20;

따라서 PhoneNumber@adbbd 보다, 010-0123-4567처럼 전화번호를 직접 알려주는 형태가 훨씬 유익한 정보를 담고 있다. 이렇듯 toString을 잘 구현한 클래스는 시스템의 디버깅을 쉽게 한다.



## toString은 그 객체가 가진 주요 정보 모두를 반환하는 게 좋다.

* 하지만, 객체가 거대하거나 객체의 상태가 문자열로 표기하기에 적합하지 않다면 무리가 있다.

> '정말 객체가 가진 모든 정보를 반환하는게 좋을까?' 고민이 필요하다.
>
> 주요 정보가 toString 값으로 로깅되는 경우(VIN, NADID 등의 개인 정보, 비밀번호...) 로그 정책에 의해\
> 개인 정보가 로그가 일정 기간 보유함으로써 여러 보안적 이슈가 발생할 수 있다.&#x20;
>
> **위 예시를 고려하여, toString은 외부 사용자에게 노출될 수 있음을 항상 인지해야한다.**\
> **이러한 이유로 toString으로 모든 정보를 반환하는 것은 고민해 볼 문제이다.**&#x20;
>
>

> equals, hashcode, toString 등 메서드를 재정의하여  사용하는 경우변형될 수 있음을 유의해야한다.\
> 필드가 추가 삭제가 될 때, 위 메서드들의 변형이 불가피 할 수 있다.&#x20;
>
> 예를 들어 A, B 필드만 존재할 때에는 equalse 메서드에서 A, B 값만 비교 했었는데, C 필드가 추가됨으로써 두 인스턴스가 더 이상 같은 값이 아니게 될 수 있다.
>
> Assertion failure: expected {abc, 123}, but was {abc, 123}.
>
> 유연하게 동작하는 메서드를 개발하는 노력이 필요하다. 변경에 따라 매번 재정의할 것이 아니라 변경에 따라 유연하게 동작하게끔(리플렉션을 이용한 개발)&#x20;

## toString의 문서화 여부를 결정해라.

toString을 구현할 때면 반환값의 포맷을 문서화할지 정해야한다. 포맷을 명시하면 그 객체는 표준적이고, 명확하고 사람이 읽을 수 있게 된다.&#x20;

따라서 그 값 그대로 입출력에 사용하거나 csv 파일처럼 사람이 읽을 수 있는 데이터 객체로 저장할 수도 있다. 포맷을 명시하기로 했다면, 명시한 포맷에 맞는 문자열과 객체를 상호 전환할 수 있는 정적 팩터리나 생성자를 함께 제공해주면 좋다.

<mark style="color:orange;">**포맷을 명시하는데에 따르는 단점도 있다. 포맷을 한번 명시하면 평생 그 포맷에 얽매이게 된다.**</mark> 이를 사용하는 프로그래머들이 그 포맷에 맞춰 파싱하고, 새로운 객체를 만들고, 영속 데이터롤 저장하는 코드를 작성할 것이다. 만약 향후 릴리즈에서 포맷을 바꾼다면 이를 사용하던 모든 코드들과 데이터들에 영향을 미치게 된다. 반대로 포맷을 명시하지 않는다면 향후 릴리즈에서 정보를 더 넣거나 포맷을 개선할 수 있는 유연성을 갖게 된다.&#x20;

### 포맷을 명시한 경우

```java
/**
 * 전화번호의 문자열 표현을 반환한다.
 * 이 문자열은 "XXX-YYYY-ZZZZ" 형태의 12글자다.
 * XXX는 통신사 식별번호, YYYY는 일련번호 앞자리, ZZZZ는 일련번호 뒷자리이다.
 * 각각의 대문자는 10진수 숫자 하나를 나타낸다. 
 * 
 * 전화번호의 각 부분이 값이 너무 작아 자릿수를 채울 수 없는 경우,
 * 앞에서부터 0으로 채워나간다.(ex: 123 -> 0123)
 * @return
 */
@Override
public String toString() {
    return String.format("%03d-%03d-%04d", prefix, middle, suffix);
}
```

### 포맷을 명시하지 않은 경우

```java
/**
 * 전화번호 정보를 반환한다.
 * 기본적으로 다음과 같은 정보를 포함한다.
 * "[통신사 식별번호: 010, 일련번호 앞자리: 1234, 일련번호 뒷자리: 5678]"
 * @return
 */
@Override
public String toString() {...}
```

포맷 명시 여부와 상관없이 toString이 반환한 값에 포함된 정보를 얻어올 수 있는 API를 제공하자. 예컨데 PhoneNumber 클래스는 지역 코드, 프리픽스, 가입자 번호용 접근자를 제공해야 한다. 그렇지 않으면 이 정보가 필요한 프로그래머는 toString의 반환값을 파싱할 수 밖에 없다.



## 요약

모든 구체 클래스에서  Object의 toString을 재정의하자. 상위 클래스에서 이미 맞게 재정의한 경우는 예외이다. toString 재정의를 통해 해당 객체에 관한 명확하고 유용한 정보를 읽기 좋은 형태로 반환해야 한다.

