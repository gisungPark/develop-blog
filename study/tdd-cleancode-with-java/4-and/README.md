# 4차 라이브 강의 - 인터페이스 & 레거시 코드 리팩터링

## 객체 설계(인터페이스 분리)

* 객체 설계와 관련한 조언들
  * 객체의 역할, 책임, 협력을 고려하면서 객체 설계
    * 역할, 책임, 협력이란 무엇인가?
  * 객체 설계 5원칙 SOLID를 지키면서 객체 설계
  * 유지보수 하기 좋도록 객체 설계
  * "응집도는 높이고, 결합도는 낮춘다!" 원칙으로 객체 설계

클래스 분리도 어려운데, 인터페이스 분리는 더 어렵다.

DI를 할때, 인터페이스와 클래스의 관계가 1:N인 경우가 대다수 이다.

<figure><img src="../../../.gitbook/assets/image (1).png" alt=""><figcaption></figcaption></figure>

* 자동차 이동 유무에 따른 요구사항 변경
  * Random 값을 기반으로 자동차의 이동 유무 판단 -> 컴퓨터의 시간을 기반으로 자동차의 유무 판단으로 요구사항 변경
  * 이동 전략을 인터페이스로 분리한다.(변경 가능성이 있는 것을 인터페이스로 분리)

<figure><img src="../../../.gitbook/assets/image (1) (1).png" alt=""><figcaption></figcaption></figure>

인터페이스를 남발하다보면 오버엔지니어링할 가능성이 있다. 인터페이스를 어느 시점에 분리할지 찾는 것은 매우 어렵다.

* 주니어일 때 흔히 경험하는 과정
  * 인터페이스 기반 개발이 멋져 보인다.
  * 디자인 패턴을 활용한 개발이 멋져 보인다.
  * 오버 엔지니어링 되면서 유지보수하기 어려운 코드를 구현한다.

적절한 인터페이스를 잘 찾으려면..&#x20;

* 내가 운영하는 서비스에 대한 이해도가 높아야 한다.
* 상당 기간의 운영 경험을 통해 요구사항의 변화가 자주 발생하는 부분을 찾아야 함.

즉, 상당 기간의 유지보수 경험 + 지속적인 리팩터링 경험이 핵심

서비스를 유지보수하다 변화가 지속적으로 발생하는 부분과 변화가 발생하지 않는 부분을 분리하는 감각이 필요하다.

* 변화가 지속적으로 발생하는 부분은 인터페이스 + 구현 클래스
* 변화가 발생하지 않는 부분은 only 구현 클래스



요구사항에 따라 if-else가 반복되는 부분이 인터페이스로 분리하기 좋은 부분이다.

* 인터페이스 분리를 위한 정량적인 원칙 찾기
  * if문 또는 switch문이 남발되고, 그 부분의 요구사항이 계속 변화한다면 인터페이스로 분리하기 좋다.
  * 방법 1 - 인터페이스와 Map Collection을 활용한 if 문 제거
  * 방법 2 - 인터페이스와 enum을 활용한 if문 제거
  * 방법 3 - 인터페이스와 List Collection을 활용한 if문 제거



시작 단계에서 완벽한 설계를 하겠다는 욕심을 버려라.\
현장의 요구사항은 끊임없이 변화한다.

<mark style="background-color:red;">**점진적으로 설계를 개선하는 연습을 하는 것이 현장형(야생) 설계 연습이다.**</mark>

























